# ILD Agents MDT (é—´è´¨æ€§è‚ºç—…å¤šå­¦ç§‘ä¼šè¯Šæ™ºèƒ½ä½“ç³»ç»Ÿ)

è¿™æ˜¯ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å¤šæ™ºèƒ½ä½“åä½œç³»ç»Ÿï¼Œæ—¨åœ¨æ¨¡æ‹Ÿé—´è´¨æ€§è‚ºç—…ï¼ˆILDï¼‰çš„å¤šå­¦ç§‘ä¼šè¯Šï¼ˆMDTï¼‰è¿‡ç¨‹ã€‚

é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œé€šè¿‡ **FastAPI** æä¾›åç«¯æœåŠ¡ï¼Œ**LangGraph** ç¼–æ’æ™ºèƒ½ä½“å·¥ä½œæµï¼Œå‰ç«¯ä½¿ç”¨ **Vue 3** æ„å»ºä¸“ä¸šçš„åŒ»ç–—ä¼šè¯Šç•Œé¢ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

*   **å¤šè§’è‰²æ™ºèƒ½ä½“åä½œ**ï¼šåŒ…å«ç—…ä¾‹æ•´ç†å‘˜ã€å½±åƒç§‘ã€ç—…ç†ç§‘ã€å‘¼å¸ç§‘ã€é£æ¹¿å…ç–«ç§‘åŠä¸»æŒä¸“å®¶ï¼ˆModeratorï¼‰ç­‰å¤šä¸ªä¸“ä¸šè§’è‰²ã€‚
*   **å®æ—¶æµå¼ä¼ è¾“**ï¼šæ”¯æŒ WebSocket åŒå‘é€šä¿¡ï¼Œå®æ—¶æµå¼è¾“å‡ºåŒ»ç”Ÿçš„è¯¦ç»†åˆ†ææ„è§å’Œæ€»ç»“ã€‚
*   **åŒé‡è¾“å‡ºæœºåˆ¶**ï¼šä¸“ç§‘åŒ»ç”ŸåŒæ—¶ç”Ÿæˆâ€œè¯¦ç»†åˆ†ææŠ¥å‘Šâ€å’Œâ€œç²¾ç®€æ€»ç»“â€ï¼Œåˆ†åˆ«å±•ç¤ºåœ¨ä¸åŒçš„ UI é¢æ¿ä¸­ã€‚
*   **å¤šè½®ä¼šè¯Šæ”¯æŒ**ï¼šæ”¯æŒå¤šè½®å¯¹è¯å’Œè¿½é—®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç»´æŠ¤ä¼šè¯Šå†å²å’Œä¸Šä¸‹æ–‡ã€‚
*   **çµæ´»çš„æ¨¡å‹é…ç½®**ï¼šæ”¯æŒåœ¨ç•Œé¢ä¸Šä¸ºä¸åŒè§’è‰²é…ç½®ä¸åŒçš„ LLM æ¨¡å‹ï¼ˆå¦‚ GPT-5.1, DeepSeek V3, Claude Haiku ç­‰ï¼‰ï¼Œå¹¶æ”¯æŒé…ç½®æŒä¹…åŒ–ã€‚
*   **ä¸“ä¸šåŒ»ç–—ç•Œé¢**ï¼šåŸºäº Element Plus è®¾è®¡çš„ç°ä»£åŒ–ç•Œé¢ï¼ŒåŒ…å«èŠå¤©é¢æ¿ã€ç»“æ„åŒ–ä¿¡æ¯å±•ç¤ºã€ä¸“ç§‘æ„è§æŠ˜å é¢æ¿ç­‰ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

### Backend (åç«¯)
*   **Python 3.10+**
*   **FastAPI**: é«˜æ€§èƒ½ Web æ¡†æ¶ï¼Œæä¾› REST API å’Œ WebSocket æœåŠ¡ã€‚
*   **LangGraph**: ç”¨äºæ„å»ºæœ‰çŠ¶æ€ã€å¤šè§’è‰²çš„æ™ºèƒ½ä½“å·¥ä½œæµã€‚
*   **OpenAI SDK**: ç»Ÿä¸€çš„å¤§æ¨¡å‹è°ƒç”¨æ¥å£ï¼ˆå…¼å®¹ DeepSeek, Claude ç­‰ï¼‰ã€‚

### Frontend (å‰ç«¯)
*   **Vue 3**: æ¸è¿›å¼ JavaScript æ¡†æ¶ã€‚
*   **Vite**: ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ã€‚
*   **Pinia**: çŠ¶æ€ç®¡ç†åº“ã€‚
*   **Element Plus**: åŸºäº Vue 3 çš„ç»„ä»¶åº“ã€‚
*   **Tailwind CSS**: åŸå­åŒ– CSS æ¡†æ¶ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿å·²å®‰è£… Python 3.10+ å’Œ Node.js 18+ã€‚

### 2. åç«¯è®¾ç½®

```bash
# 1. å…‹éš†é¡¹ç›®å¹¶è¿›å…¥ç›®å½•
git clone <repository_url>
cd ILDAgentsMDT

# 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (æ¨è)
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. é…ç½®ç¯å¢ƒå˜é‡
# å¤åˆ¶ .env.example ä¸º .env å¹¶å¡«å…¥ä½ çš„ API Key
cp .env.example .env
```

### 3. å‰ç«¯è®¾ç½®

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install
```

### 4. å¯åŠ¨é¡¹ç›®

ä½ éœ€è¦åŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯æœåŠ¡ã€‚

**ç»ˆç«¯ 1 (åç«¯):**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹
python server.py
# æœåŠ¡å°†è¿è¡Œåœ¨ http://localhost:18000
```

**ç»ˆç«¯ 2 (å‰ç«¯):**
```bash
# åœ¨ frontend ç›®å½•ä¸‹
npm run dev
# é¡µé¢å°†è¿è¡Œåœ¨ http://localhost:15173
```

**åŒæ­¥å¯åŠ¨:**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹
./start.sh
# é¡µé¢å°†è¿è¡Œåœ¨ http://localhost:15173
```

## ğŸ“‚ ç›®å½•ç»“æ„

```
ILDAgentsMDT/
â”œâ”€â”€ agents/                 # æ™ºèƒ½ä½“å®ç°
â”‚   â”œâ”€â”€ case_organizer/     # ç—…ä¾‹æ•´ç†å‘˜
â”‚   â”œâ”€â”€ moderator/          # ä¸»æŒä¸“å®¶
â”‚   â”œâ”€â”€ radiologist/        # å½±åƒç§‘åŒ»ç”Ÿ
â”‚   â”œâ”€â”€ ...                 # å…¶ä»–ä¸“ç§‘åŒ»ç”Ÿ
â”‚   â””â”€â”€ base.py             # Agent åŸºç±»
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ llm_config.py       # æ¨¡å‹é…ç½®å®šä¹‰
â”‚   â””â”€â”€ settings.py         # ç¯å¢ƒå˜é‡åŠ è½½
â”œâ”€â”€ core/                   # æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ pipeline.py         # LangGraph å·¥ä½œæµæ„å»º
â”‚   â”œâ”€â”€ pipeline_api.py     # API é€‚é…å±‚
â”‚   â”œâ”€â”€ shared_state.py     # å…±äº«çŠ¶æ€å®šä¹‰
â”‚   â””â”€â”€ nodes/              # å›¾èŠ‚ç‚¹å·¥å‚å‡½æ•°
â”œâ”€â”€ frontend/               # Vue 3 å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/            # Axios & WebSocket å°è£…
â”‚   â”‚   â”œâ”€â”€ components/     # Vue ç»„ä»¶ (ChatPanel, InfoPanel, Sidebar...)
â”‚   â”‚   â”œâ”€â”€ stores/         # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ App.vue         # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ ...
â”œâ”€â”€ llm/                    # LLM å®¢æˆ·ç«¯å°è£…
â”œâ”€â”€ server.py               # FastAPI å…¥å£æ–‡ä»¶
â””â”€â”€ requirements.txt        # Python ä¾èµ–
```

## âš™ï¸ æ¨¡å‹é…ç½®

é¡¹ç›®æ”¯æŒå¤šç§å¤§æ¨¡å‹é…ç½®ã€‚ä½ å¯ä»¥åœ¨ `config/llm_config.py` ä¸­å®šä¹‰é¢„è®¾æ¨¡å‹ï¼Œæˆ–è€…åœ¨å‰ç«¯ç•Œé¢çš„â€œé…ç½®é¢æ¿â€ä¸­åŠ¨æ€é€‰æ‹©ã€‚

æ”¯æŒçš„æ¨¡å‹é¢„è®¾åŒ…æ‹¬ï¼š
- GPT-5.1
- DeepSeek V3
- Claude Haiku
- Gemini 2.5 Pro
- Grok 4
- Qwen 3

## ğŸ“ å¼€å‘æŒ‡å—

- **æ·»åŠ æ–°è§’è‰²**ï¼š
  1. åœ¨ `agents/` ä¸‹åˆ›å»ºæ–°è§’è‰²çš„æ–‡ä»¶å¤¹ã€‚
  2. ç»§æ‰¿ `BaseAgent` å®ç° `run` æ–¹æ³•ã€‚
  3. åœ¨ `core/pipeline.py` ä¸­æ³¨å†Œæ–°èŠ‚ç‚¹ã€‚
  4. åœ¨ `frontend/src/components/Sidebar.vue` ä¸­æ·»åŠ é€‰é¡¹ã€‚

- **ä¿®æ”¹ Prompt**ï¼š
  æ¯ä¸ª Agent çš„ Prompt ä½äºå…¶ç›®å½•ä¸‹çš„ `prompts/` æ–‡ä»¶å¤¹ä¸­ã€‚

## ğŸ“„ License

MIT License

## ğŸ³ Docker éƒ¨ç½²

é¡¹ç›®æä¾›äº† `docker-compose.yml`ï¼ŒåŒ…å«ä¸¤ä¸ªæœåŠ¡ï¼š`backend`ï¼ˆFastAPIï¼‰å’Œ `frontend`ï¼ˆé™æ€æ–‡ä»¶ç”± nginx æä¾›ï¼‰ã€‚ä¸‹é¢æ˜¯å¸¸ç”¨çš„æ„å»ºä¸å¯åŠ¨å‘½ä»¤ï¼š

1) ä½¿ç”¨ Docker Compose ä¸€é”®æ„å»ºå¹¶å¯åŠ¨ï¼ˆç”Ÿäº§/æµ‹è¯•ï¼‰ï¼š

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹
docker compose build
docker compose up -d
```

2) ä»…æ„å»ºå¹¶è¿è¡Œåç«¯ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰ï¼š

```bash
docker build -f Dockerfile.backend -t ildagents-backend:latest .
docker run --rm -p 18000:18000 --env-file .env ildagents-backend:latest
```

3) ä»…æ„å»ºå¹¶è¿è¡Œå‰ç«¯ï¼ˆç”Ÿäº§é™æ€ï¼Œnginxï¼‰ï¼š

```bash
cd frontend
docker build -t ildagents-frontend:latest .
docker run --rm -p 80:80 ildagents-frontend:latest
```

é…ç½®æç¤ºï¼š
- å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å†™å¿…è¦çš„ API Keyï¼ˆå¦‚ `OPENAI_API_KEY`ï¼‰ã€‚
- è‹¥åç«¯éœ€è¦ä½¿ç”¨å¤–éƒ¨ç¼“å­˜ï¼ˆRedisï¼‰æˆ–æ•°æ®åº“ï¼Œè¯·åœ¨ `docker-compose.yml` ä¸­æ–°å¢å¯¹åº”æœåŠ¡å¹¶åœ¨ `.env` ä¸­é…ç½®è¿æ¥å­—ç¬¦ä¸²ã€‚

ç«¯å£ä¸è·¯ç”±ï¼š
- åç«¯é»˜è®¤ç›‘å¬ `18000`ï¼ˆWebSocket è·¯å¾„ `/ws/consultation/{session_id}` å’Œ REST è·¯å¾„ `/api/...`ï¼‰ã€‚
- å‰ç«¯ç”± nginx åœ¨å®¹å™¨å†…ç›‘å¬ `80`ï¼Œå¹¶å°† `/api` ä¸ `/ws` åå‘ä»£ç†åˆ° `backend:18000`ï¼ˆå‚è§ `frontend/nginx.conf`ï¼‰ã€‚

ç”Ÿäº§å»ºè®®ï¼š
- å°† `uvicorn` æ¢æˆ `gunicorn` + `uvicorn.workers.UvicornWorker` æˆ–ä½¿ç”¨å¤š `uvicorn` worker æ¥æé«˜å¹¶å‘ã€‚ç¤ºä¾‹ï¼š

```bash
gunicorn -k uvicorn.workers.UvicornWorker server:app --bind 0.0.0.0:18000 --workers 4
```

- ä½¿ç”¨å¤–éƒ¨åå‘ä»£ç†ï¼ˆå¦‚ Traefik / nginxï¼‰æ¥å¤„ç† TLSã€åŸŸåå’Œè´Ÿè½½å‡è¡¡ã€‚
- å°†æ•æ„Ÿç¯å¢ƒå˜é‡å­˜æ”¾åœ¨å®‰å…¨çš„ secret ç®¡ç†ä¸­ï¼ˆä¸è¦æŠŠ `.env` ä¸Šä¼ åˆ°ä»“åº“ï¼‰ã€‚
